<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;

class screenIXDebeloCrevo extends Controller
{
    public function __construct()
    {
    }
    function rizikBMI($pol, $bmi, $age)
    {
        //[pol, godine_od, godine_do, bmi_od, bmi_do, risk_bmi]
        $list_bmi = [
            [1, 0, 25, 0, 18.499999999999, 0.05], [2, 0, 25, 0, 18.499999999999, 0.03], [1, 26, 32, 0, 18.499999999999, 0.18], [2, 26, 32, 0, 18.499999999999, 0.2],
            [1, 33, 49, 0, 18.499999999999, 0.37], [2, 33, 49, 0, 18.499999999999, 0.4], [1, 50, 59, 0, 18.499999999999, 0.43], [2, 50, 59, 0, 18.499999999999, 0.46],
            [1, 60, 69, 0, 18.499999999999, 0.5], [2, 60, 69, 0, 18.499999999999, 0.52], [1, 70, 85, 0, 18.499999999999, 0.63], [2, 70, 85, 0, 18.499999999999, 0.67],
            [1, 86, 150, 0, 18.499999999999, 0.72], [2, 86, 150, 0, 18.499999999999, 0.75],
            [1, 0, 25, 18.5, 24.9999999, 0.02], [2, 0, 25, 18.5, 24.9999999, 0.03], [1, 26, 32, 18.5, 24.9999999, 0.1], [2, 26, 32, 18.5, 24.9999999, 0.12],
            [1, 33, 49, 18.5, 24.9999999, 0.19], [2, 33, 49, 18.5, 24.9999999, 0.2], [1, 50, 59, 18.5, 24.9999999, 0.3], [2, 50, 59, 18.5, 24.9999999, 0.35],
            [1, 60, 69, 18.5, 24.9999999, 0.45], [2, 60, 69, 18.5, 24.9999999, 0.5], [1, 70, 85, 18.5, 24.9999999, 0.57], [2, 70, 85, 18.5, 24.9999999, 0.6],
            [1, 86, 150, 18.5, 24.9999999, 0.6], [2, 86, 150, 18.5, 24.9999999, 0.64],
            [1, 0, 25, 25, 27.5999999, 0.05], [2, 0, 25, 25, 27.5999999, 0.06], [1, 26, 32, 25, 27.5999999, 0.2], [2, 26, 32, 25, 27.5999999, 0.23],
            [1, 33, 49, 25, 27.5999999, 0.28], [2, 33, 49, 25, 27.5999999, 0.3], [1, 50, 59, 25, 27.5999999, 0.56], [2, 50, 59, 25, 27.5999999, 0.59],
            [1, 60, 69, 25, 27.5999999, 0.65], [2, 60, 69, 25, 27.5999999, 0.64], [1, 70, 85, 25, 27.5999999, 0.72], [2, 70, 85, 25, 27.5999999, 0.7],
            [1, 86, 150, 25, 27.5999999, 0.8], [2, 86, 150, 25, 27.5999999, 0.75],
            [1, 0, 25, 27.6, 29.9999, 0.08], [2, 0, 25, 27.6, 29.9999, 0.1], [1, 26, 32, 27.6, 29.9999, 0.26], [2, 26, 32, 27.6, 29.9999, 0.29],
            [1, 33, 49, 27.6, 29.9999, 0.35], [2, 33, 49, 27.6, 29.9999, 0.39], [1, 50, 59, 27.6, 29.9999, 0.6], [2, 50, 59, 27.6, 29.9999, 0.6],
            [1, 60, 69, 27.6, 29.9999, 0.69], [2, 60, 69, 27.6, 29.9999, 0.65], [1, 70, 85, 27.6, 29.9999, 0.78], [2, 70, 85, 27.6, 29.9999, 0.7],
            [1, 86, 150, 27.6, 29.9999, 0.82], [2, 86, 150, 27.6, 29.9999, 0.76],
            [1, 0, 25, 30, 120, 0.11], [2, 0, 25, 30, 120, 0.14], [1, 26, 32, 30, 120, 0.3], [2, 26, 32, 30, 120, 0.34],
            [1, 33, 49, 30, 120, 0.4], [2, 33, 49, 30, 120, 0.43], [1, 50, 59, 30, 120, 0.68], [2, 50, 59, 30, 120, 0.69],
            [1, 60, 69, 30, 120, 0.75], [2, 60, 69, 30, 120, 0.74], [1, 70, 85, 30, 120, 0.82], [2, 70, 85, 30, 120, 0.77],
            [1, 86, 150, 30, 120, 0.88], [2, 86, 150, 30, 120, 0.8]
        ];
        $rizik_bmi = 0;
        foreach ($list_bmi as $x) {
            if ($pol == $x[0]) {
                if ($x[1] <= $age and $x[2] >= $age) {
                    if ($x[3] <= $bmi and $x[4] >= $bmi)
                        $rizik_bmi = $x[5];
                }
            } else {
                if ($x[1] <= $age and $x[2] >= $age) {
                    if ($x[3] <= $bmi and $x[4] >= $bmi)
                        $rizik_bmi = $x[5];
                }
            }
        }
        return $rizik_bmi;
    }
    function rizikWL($pol, $age, $dijeta, $a, $b, $c)
    {
        //[pol, godine_od, godine_do, drzi dijetu 1, ne drzi dijetu 0, r_pocetna, r krajnja, verovatnoca]
        $list_wl = [
            [1, 0, 25, 1, 0, 0.04999999, 0.06], [2, 0, 25, 1, 0, 0.04999999, 0.08], [1, 26, 32, 1, 0, 0.0499999, 0.25], [2, 26, 32, 0, 0, 0.0499999, 0.3],
            [1, 33, 49, 1, 0, 0.0499999, 0.4], [2, 33, 49, 1, 0, 0.0499999, 0.44], [1, 50, 59, 1, 0, 0.0499999, 0.45], [2, 50, 59, 1, 0, 0.0499999, 0.5],
            [1, 60, 69, 1, 0, 0.0499999, 0.55], [2, 60, 69, 1, 0, 0.0499999, 0.55], [1, 70, 85, 1, 0, 0.0499999, 0.64], [2, 70, 85, 1, 0, 0.0499999, 0.65],
            [1, 86, 150, 1, 0, 0.0499999, 0.75], [2, 86, 150, 1, 0, 0.0499999, 0.7],
            [1, 0, 25, 1, 0.05, 0.09999999, 0.2], [2, 0, 25, 1, 0.05, 0.09999999, 0.27], [1, 26, 32, 1, 0.05, 0.09999999, 0.3], [2, 26, 32, 1, 0.05, 0.09999999, 0.32],
            [1, 33, 49, 1, 0.05, 0.09999999, 0.4], [2, 33, 49, 1, 0.05, 0.09999999, 0.43], [1, 50, 59, 1, 0.05, 0.09999999, 0.57], [2, 50, 59, 1, 0.05, 0.09999999, 0.6],
            [1, 60, 69, 1, 0.05, 0.09999999, 0.65], [2, 60, 69, 1, 0.05, 0.09999999, 0.66], [1, 70, 85, 1, 0.05, 0.09999999, 0.72], [2, 70, 85, 1, 0.05, 0.09999999, 0.75],
            [1, 86, 150, 1, 0.05, 0.09999999, 0.8], [2, 86, 150, 1, 0.05, 0.09999999, 0.79],
            [1, 0, 25, 1, 0.1, 0.24999999, 0.4], [2, 0, 25, 1, 0.1, 0.24999999, 0.42], [1, 26, 32, 1, 0.1, 0.24999999, 0.46], [2, 26, 32, 1, 0.1, 0.24999999, 0.5],
            [1, 33, 49, 1, 0.1, 0.24999999, 0.56], [2, 33, 49, 1, 0.1, 0.24999999, 0.57], [1, 50, 59, 1, 0.1, 0.24999999, 0.69], [2, 50, 59, 1, 0.1, 0.24999999, 0.73],
            [1, 60, 69, 1, 0.1, 0.24999999, 0.78], [2, 60, 69, 1, 0.1, 0.24999999, 0.74], [1, 70, 85, 1, 0.1, 0.24999999, 0.85], [2, 70, 85, 1, 0.1, 0.24999999, 0.8],
            [1, 86, 150, 1, 0.1, 0.24999999, 0.9], [2, 86, 150, 1, 0.1, 0.24999999, 0.85],
            [1, 0, 25, 1, 0.25, 100, 0.5], [2, 0, 25, 1, 0.25, 100, 0.55], [1, 26, 32, 1, 0.25, 100, 0.6], [2, 26, 32, 1, 0.25, 100, 0.64],
            [1, 33, 49, 1, 0.25, 100, 0.7], [2, 33, 49, 1, 0.25, 100, 0.72], [1, 50, 59, 1, 0.25, 100, 0.76], [2, 50, 59, 1, 0.25, 100, 0.75],
            [1, 60, 69, 1, 0.25, 100, 0.82], [2, 60, 69, 1, 0.25, 100, 0.79], [1, 70, 85, 1, 0.25, 100, 0.85], [2, 70, 85, 1, 0.25, 100, 0.82],
            [1, 86, 150, 1, 0.25, 100, 0.92], [2, 86, 150, 1, 0.25, 100, 0.88],
            [1, 0, 25, 1, 0.25, 100, 0.6], [2, 0, 25, 1, 0.25, 100, 0.62], [1, 26, 32, 1, 0.25, 100, 0.66], [2, 26, 32, 1, 0.25, 100, 0.7],
            [1, 33, 49, 1, 0.25, 100, 0.76], [2, 33, 49, 1, 0.25, 100, 0.77], [1, 50, 59, 1, 0.25, 100, 0.89], [2, 50, 59, 1, 0.25, 100, 0.93],
            [1, 60, 69, 1, 0.25, 100, 0.98], [2, 60, 69, 1, 0.25, 100, 0.94], [1, 70, 85, 1, 0.25, 100, 1], [2, 70, 85, 1, 0.25, 100, 1],
            [1, 86, 150, 1, 0.25, 100, 1], [2, 86, 150, 1, 0.25, 100, 1]
        ];
        $risk_wl = 0;
        $s1 = $b / $a;
        $s2 = $c / $b;
        foreach ($list_wl as $x) {
            if ($pol == $x[0]) {
                if ($x[1] <= $age and $x[2] >= $age) {
                    if ($dijeta == 1) {
                        if ($s1 != 0 and $s2 != 0) {
                            $r = ($c - $b) / ($b - $a);
                            if ($x[4] < $r and $x[5] > $r) {
                                $risk_wl = $x[6];
                            }
                        } else if ($s1 == 0 and $s2 != 0) {
                            $r = $s2;
                            if ($x[4] < $r and $x[5] > $r) {
                                $risk_wl = $x[6] * 0.75;
                            }
                        } else {
                            $risk_wl = 1;
                        }
                    } else {
                        if ($s1 != 0 and $s2 != 0) {
                            $r = ($c - $b) / ($b - $a);
                            if ($x[4] < $r and $x[5] > $r) {
                                $risk_wl = $x[6] * 0.3;
                            }
                        } else if ($s1 == 0 and $s2 != 0) {
                            $r = $s2;
                            if ($x[4] < $r and $x[5] > $r) {
                                $risk_wl = $x[6] * 0.24;
                            }
                        } else {
                            $risk_wl = 0.1;
                        }
                    }
                }
            } else {
                if ($x[1] <= $age and $x[2] >= $age) {
                    if ($dijeta == 0) {
                        if ($s1 != 0 and $s2 != 0) {
                            $r = ($c - $b) / ($b - $a);
                            if ($x[4] < $r and $x[5] > $r) {
                                $risk_wl = $x[6];
                            }
                        } else if ($s1 == 0 and $s2 != 0) {
                            $r = $s2;
                            if ($x[4] < $r and $x[5] > $r) {
                                $risk_wl = $x[6] * 0.75;
                            }
                        } else {
                            $risk_wl = 1;
                        }
                    } else {
                        if ($s1 != 0 and $s2 != 0) {
                            $r = ($c - $b) / ($b - $a);
                            if ($x[4] < $r and $x[5] > $r) {
                                $risk_wl = $x[6] * 0.2;
                            }
                        } else if ($s1 == 0 and $s2 != 0) {
                            $r = $s2;
                            if ($x[4] < $r and $x[5] > $r) {
                                $risk_wl = $x[6] * 0.15;
                            }
                        } else {
                            $risk_wl = 0.1;
                        }
                    }
                }
            }
        }
        return $risk_wl;
    }
    function rizikKorak1($bmi, $pol, $age, $dijeta, $a, $b, $c)
    {
        $rizik = ($this->rizikBMI($pol, $bmi, $age) * 7 + 4 * $this->rizikWL($pol, $age, $dijeta, $a, $b, $c)) / 11;
        return (int) ($rizik * 100);
    }
}
